## Typical structure of a REST project in Go

Наиболее распространенный подход основан на **разделении по доменам (или фичам)** и **"чистой архитектуре"/слоях**. Это обычно выглядит:

```
my-go-rest-api/  
├── cmd/  
│   └── api/  
│       └── main.go           \# Точка входа в приложение, инициализация сервера и роутера.  
├── internal/                   \# Внутренний код, который не должен импортироваться извне репозитория.  
│   ├── handlers/               \# Обработчики HTTP-запросов (контроллеры)  
│   │   ├── user\_handler.go     \# Функции, отвечающие за роуты /api/users  
│   │   ├── product\_handler.go  \# Функции, отвечающие за роуты /api/products  
│   │   └── health\_handler.go   \# Проверка состояния сервиса (/health)  
│   ├── services/               \# Бизнес-логика, не зависящая от HTTP  
│   │   ├── user\_service.go     \# Логика работы с пользователями (создание, чтение, обновление, удаление)  
│   │   └── product\_service.go  \# Логика работы с продуктами  
│   ├── repository/             \# Уровень доступа к данным (взаимодействие с БД, кешем и т.д.)  
│   │   ├── user\_repo.go        \# Методы для работы с таблицей пользователей в БД  
│   │   ├── product\_repo.go     \# Методы для работы с таблицей продуктов в БД  
│   │   └── database.go         \# Инициализация подключения к БД  
│   ├── models/                 \# Структуры данных (DTOs, модели предметной области)  
│   │   ├── user.go             \# Структура User  
│   │   └── product.go          \# Структура Product  
│   └── middleware/             \# Функции промежуточного ПО (CORS, аутентификация, логирование)  
│       ├── auth.go  
│       └── cors.go  
│       └── logger.go  
├── pkg/                        \# Пакеты, которые можно безопасно импортировать извне репозитория  
│   └── utils/  
│       └── helpers.go          \# Общие вспомогательные функции (например, валидация, утилиты)  
│   └── errors/  
│       └── errors.go           \# Пользовательские типы ошибок  
├── api/                        \# Описание API (OpenAPI/Swagger спецификации)  
│   └── openapi.yaml  
├── configs/                    \# Файлы конфигурации (YAML, JSON)  
│   └── config.yaml  
├── scripts/                    \# Скрипты для сборки, развертывания, миграции БД  
│   └── run.sh  
├── .env                        \# Переменные окружения (для локальной разработки)  
├── .gitignore  
├── go.mod                      \# Описание модуля Go и зависимости  
├── go.sum                      \# Контрольные суммы зависимостей  
└── Dockerfile                  \# Файл для создания Docker-образа
```

---

## **Как по этой структуре обычно располагают контент проекта**

Назначение каждой папки:

1. **`cmd/`**  
   * **Назначение:** Точки входа в исполняемые приложения. Если у вас несколько исполняемых файлов (например, API-сервер, отдельный сервис для фоновых задач, CLI-утилита), каждый из них будет иметь свою подпапку здесь.  
   * **Контент:** В нашем случае, cmd/api/main.go — это основной файл, который инициализирует все компоненты приложения (роутер, базу данных, сервисы, хэндлеры) и запускает HTTP-сервер.  
2. **`internal/`**  
   * **Назначение:** Это **очень важная** папка в проектах на Go. Она содержит код, который **предназначен только для использования внутри текущего модуля** (репозитория) и **не должен импортироваться другими Go-модулями** или репозиториями. Это помогает инкапсулировать внутреннюю логику и предотвращает нежелательные внешние зависимости.  
   * **Контент:**  
     * `handlers/`: Здесь находятся функции-обработчики, которые получают HTTP-запросы от роутера, извлекают данные, вызывают соответствующую бизнес-логику из services и формируют HTTP-ответ. Это ваш "слой контроллеров".  
     * `services/`: Содержит основную **бизнес-логику** приложения. Эти пакеты должны быть независимы от деталей HTTP (они не должны знать, что такое http.ResponseWriter или \*http.Request). Они принимают простые структуры данных и возвращают их. Сервисы используют репозитории для доступа к данным.  
     * `repository/` (или storage/, dao/): Здесь находится код, отвечающий за **доступ к данным**. Это может быть взаимодействие с базой данных (PostgreSQL, MongoDB), внешними API, файловой системой или кешем. Репозитории инкапсулируют логику работы с конкретным хранилищем.  
     * `models/` (или domain/, entity/): Содержит **структуры данных**, которые представляют сущности вашей предметной области. Эти структуры могут использоваться всеми слоями (но могут быть и DTO, специфичные для каждого слоя).  
     * `middleware/`: Пользовательские функции middleware (промежуточное ПО), такие как CORS, аутентификация, авторизация, логирование запросов и т.д.  
3. **`pkg/`**  
   * **Назначение:** Пакеты, которые могут быть **безопасно импортированы внешними Go-модулями или приложениями**. Если у вас есть какая-то общая библиотека или утилиты, которые могут быть полезны в других ваших проектах, их следует поместить сюда.  
   * **Контент:** utils/ (вспомогательные функции), errors/ (пользовательские типы ошибок). Если бы вы делали, например, общую библиотеку для работы с JWT токенами, которую могли бы использовать другие микросервисы, она бы пошла сюда.  
4. **`api/`**  
   * **Назначение:** Хранение спецификаций вашего API.  
   * **Контент:** Файлы OpenAPI/Swagger (openapi.yaml или swagger.json), которые описывают все эндпоинты, форматы запросов и ответов. Это ключ к хорошей документации и автоматической генерации кода.  
5. **`configs/`**  
   * **Назначение:** Хранение всех конфигурационных файлов для различных сред (разработка, тестирование, продакшен).  
   * **Контент:** config.yaml, config.json, config.toml и т.д. Эти файлы обычно читаются приложением при старте.  
6. **`scripts/`**  
   * **Назначение:** Скрипты автоматизации различных задач.  
   * **Контент:** Скрипты для сборки Docker-образов, запуска тестов, миграции базы данных, развертывания.  
7. **`.env`**  
   * **Назначение:** Файл для хранения переменных окружения, используемых для локальной разработки.  
   * **Контент:** Пары ключ-значение (например, DB\_URL=..., API\_KEY=...). **Всегда включаем его в .gitignore**, так как он содержит конфиденциальные данные.  
8. **`go.mod` и `go.sum`**  
   * **Назначение:** Основные файлы для управления зависимостями Go-модуля.  
   * **Контент:** go.mod определяет имя вашего модуля и его прямые зависимости. go.sum содержит контрольные суммы всех зависимостей, обеспечивая их целостность.  
9. **`Dockerfile`**  
   * **Назначение:** Описание процесса сборки Docker-образа для вашего приложения.  
   * **Контент:** Инструкции для Docker по созданию контейнера с вашим Go-приложением.

---

### **Почему такая структура?**

Эта структура призвана достичь следующих целей:

* **Разделение ответственности (Separation of Concerns):** Каждый пакет или папка имеет четко определенную задачу.  
* **Чистая архитектура/Слои (Clean Architecture/Layers):** Код организован в слои (контроллеры \-\> сервисы \-\> репозитории), где каждый слой зависит только от нижележащих. Это делает код более тестируемым и легким для модификации.  
* **Инкапсуляция (internal/):** Защищает внутренний код от непреднамеренного использования извне.  
* **Удобство для команды:** Чёткая структура помогает новым разработчикам быстро понять проект и где что находится.  
* **Масштабируемость:** По мере роста проекта легко добавлять новые функции, не нарушая существующую структуру.